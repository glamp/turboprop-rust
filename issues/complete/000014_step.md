# Step 14: Add Glob Dependencies and Basic Pattern Types

## Objective
Add the foundational dependencies and types needed for file glob pattern filtering support.

## Tasks
1. Add `glob` crate dependency to Cargo.toml
2. Create basic glob pattern type and validation in filters module
3. Add unit tests for glob pattern validation
4. Ensure all existing tests continue to pass

## Background
The specification requires adding a `--filter` flag that accepts Unix shell-style glob patterns (like `src/*.js`) to filter search results by file path patterns, similar to ripgrep's `-g` flag functionality.

## Dependencies to Add
- `glob = "0.3"` - Official Rust crate for Unix shell-style pattern matching

## Implementation Details

### 1. Cargo.toml Changes
Add glob dependency to the `[dependencies]` section:
```toml
glob = "0.3"
```

### 2. Filter Module Extensions
Add to `src/filters.rs`:
- New `GlobPattern` wrapper type for validated glob patterns
- `validate_glob_pattern()` function with comprehensive validation
- Support for common patterns: `*.ext`, `dir/*.ext`, `**/pattern`, etc.
- Case-sensitive pattern matching (consistent with Unix shell behavior)

### 3. Validation Requirements
The glob pattern validation should:
- Reject empty patterns
- Validate pattern syntax using glob crate
- Handle edge cases (invalid Unicode, overly complex patterns)
- Provide helpful error messages for invalid patterns
- Support both relative and absolute-style patterns

### 4. Test Coverage
Create comprehensive tests for:
- Valid glob patterns (`*.rs`, `src/*.js`, `**/test_*.py`)
- Invalid patterns (malformed syntax, empty strings)
- Edge cases (Unicode characters, very long patterns)
- Pattern normalization if needed

## Acceptance Criteria
- [ ] `glob` crate added to dependencies
- [ ] `GlobPattern` type with validation implemented
- [ ] `validate_glob_pattern()` function with error handling
- [ ] All validation edge cases covered by tests
- [ ] Existing functionality unaffected (all previous tests pass)
- [ ] Code follows project formatting standards (`cargo fmt`)
- [ ] No compiler warnings or errors

## Files to Create/Modify
- `Cargo.toml` - Add glob dependency
- `src/filters.rs` - Add GlobPattern type and validation
- `src/filters.rs` - Add comprehensive test cases

## Success Validation
Run these commands to validate the step:
```bash
cargo build
cargo test filters::test_glob_pattern
cargo fmt --check
```

## Notes
This step establishes the foundation for glob pattern support without changing any CLI interfaces or breaking existing functionality. The actual glob filtering logic will be implemented in subsequent steps.

## Proposed Solution

I will implement this step using Test Driven Development with the following approach:

1. **Add glob dependency** - Add `glob = "0.3"` to Cargo.toml dependencies section
2. **Examine existing filters.rs** - Understand current module structure and patterns
3. **Create GlobPattern type** - Implement a wrapper type that validates glob patterns
4. **Implement validation function** - Create `validate_glob_pattern()` with comprehensive error handling
5. **Write comprehensive tests** - Cover valid patterns, invalid patterns, and edge cases
6. **Ensure no regressions** - Run existing tests to verify compatibility
7. **Format and validate** - Run cargo fmt and ensure no warnings

The implementation will focus on:
- Creating a `GlobPattern` struct that wraps a validated pattern string
- Using the glob crate's `Pattern::new()` for validation
- Providing clear error messages for invalid patterns
- Supporting common patterns like `*.rs`, `src/*.js`, `**/test_*.py`
- Handling edge cases like empty strings, invalid Unicode, and overly complex patterns